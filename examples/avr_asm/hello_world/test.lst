.EQU core_freq = 8
.EQU os_feature_ir_table = 1
.EQU os_feature_logging = 1
.EQU os_feature_timer1 = 1
.EQU os_feature_timer2 = 1
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/devices/atmega328.def
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/defs/avr/atmega328.inc
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/defs/avr/common.inc
.DEF xl = r26
.DEF xh = r27
.DEF yl = r28
.DEF yh = r29
.DEF zl = r30
.DEF zh = r31
.DEVICE atmega328p
.EQU flash_size = 32768
.EQU flash_pagesize = 128
.EQU eeprom_size = 1024
.EQU eeprom_pagesize = 4
.EQU sram_start = 256
.EQU sram_size = 2048
.EQU sreg = 95
.EQU sph = 94
.EQU spl = 93
.EQU mcucsr = 84
.EQU mcusr = 84
.EQU wdrf = 3
.EQU borf = 2
.EQU extrf = 1
.EQU porf = 0
.EQU prr = 100
.EQU prtwi = 7
.EQU prtim2 = 6
.EQU prtim0 = 5
.EQU prtim1 = 3
.EQU prspi = 2
.EQU prusart0 = 1
.EQU pradc = 0
.EQU twcr = 188
.EQU twint = 7
.EQU twea = 6
.EQU twsta = 5
.EQU twsto = 4
.EQU twwc = 3
.EQU twen = 2
.EQU twie = 0
.EQU twdr = 187
.EQU twar = 186
.EQU twgce = 0
.EQU twsr = 185
.EQU twps1 = 1
.EQU twps0 = 0
.EQU twbr = 184
.EQU timsk0 = 110
.EQU ocie0b = 2
.EQU ocie0a = 1
.EQU toie0 = 0
.EQU tccr0a = 68
.EQU com0a1 = 7
.EQU com0a0 = 6
.EQU com0b1 = 5
.EQU com0b0 = 4
.EQU wgm01 = 1
.EQU wgm00 = 0
.EQU tccr0b = 69
.EQU foc0a = 7
.EQU foc0b = 6
.EQU wgm02 = 3
.EQU cs02 = 2
.EQU cs01 = 1
.EQU cs00 = 0
.EQU tcnt0 = 70
.EQU ocr0a = 71
.EQU ocr0b = 72
.EQU tifr0 = 53
.EQU ocf0b = 2
.EQU ocf0a = 1
.EQU tov0 = 0
.EQU timsk1 = 111
.EQU icie1 = 5
.EQU ocie1b = 2
.EQU ocie1a = 1
.EQU toie1 = 0
.EQU tccr1a = 128
.EQU com1a1 = 7
.EQU com1a0 = 6
.EQU com1b1 = 5
.EQU com1b0 = 4
.EQU wgm11 = 1
.EQU wgm10 = 0
.EQU tccr1b = 129
.EQU icnc1 = 7
.EQU ices1 = 6
.EQU wgm13 = 4
.EQU wgm12 = 3
.EQU cs12 = 2
.EQU cs11 = 1
.EQU cs10 = 0
.EQU tccr1c = 130
.EQU foc1a = 7
.EQU foc1b = 6
.EQU tcnt1h = 133
.EQU tcnt1l = 132
.EQU ocr1ah = 137
.EQU ocr1al = 136
.EQU ocr1bh = 139
.EQU ocr1bl = 138
.EQU tifr1 = 54
.EQU icf1 = 5
.EQU ocf1b = 2
.EQU ocf1a = 1
.EQU tov1 = 0
.EQU timsk2 = 112
.EQU ocie2b = 2
.EQU ocie2a = 1
.EQU toie2 = 0
.EQU tccr2a = 176
.EQU com2a1 = 7
.EQU com2a0 = 6
.EQU com2b1 = 5
.EQU com2b0 = 4
.EQU wgm21 = 1
.EQU wgm20 = 0
.EQU tccr2b = 177
.EQU foc2a = 7
.EQU foc2b = 6
.EQU wgm22 = 3
.EQU cs22 = 2
.EQU cs21 = 1
.EQU cs20 = 0
.EQU tcnt2 = 178
.EQU ocr2a = 179
.EQU ocr2b = 180
.EQU tifr2 = 55
.EQU ocf2b = 2
.EQU ocf2a = 1
.EQU tov2 = 0
.EQU udr0 = 198
.EQU ucsr0a = 192
.EQU rxc0 = 7
.EQU txc0 = 6
.EQU udre0 = 5
.EQU fe0 = 4
.EQU dor0 = 3
.EQU upe0 = 2
.EQU u2x0 = 1
.EQU mpcm0 = 0
.EQU ucsr0b = 193
.EQU rxcie0 = 7
.EQU txcie0 = 6
.EQU udrie0 = 5
.EQU rxen0 = 4
.EQU txen0 = 3
.EQU ucsz02 = 2
.EQU rxb80 = 1
.EQU txb80 = 0
.EQU ucsr0c = 194
.EQU umsel01 = 7
.EQU umsel00 = 6
.EQU upm01 = 5
.EQU upm00 = 4
.EQU usbs0 = 3
.EQU ucsz01 = 2
.EQU udcrd0 = 2
.EQU ucsz00 = 1
.EQU ucpha0 = 1
.EQU ucpol0 = 0
.EQU ursel0 = 8
.EQU ubrr0h = 197
.EQU ubrr0l = 196
.EQU pcicr = 104
.EQU pcie2 = 2
.EQU pcie1 = 1
.EQU pcie0 = 0
.EQU pcifr = 59
.EQU pcif2 = 2
.EQU pcif1 = 2
.EQU pcif0 = 0
.EQU pcmsk0 = 107
.EQU pcint7 = 7
.EQU pcint6 = 6
.EQU pcint5 = 5
.EQU pcint4 = 4
.EQU pcint3 = 3
.EQU pcint2 = 2
.EQU pcint1 = 1
.EQU pcint0 = 0
.EQU pcmsk1 = 108
.EQU pcint14 = 6
.EQU pcint13 = 5
.EQU pcint12 = 4
.EQU pcint11 = 3
.EQU pcint10 = 2
.EQU pcint9 = 1
.EQU pcint8 = 0
.EQU pcmsk2 = 109
.EQU pcint23 = 7
.EQU pcint22 = 6
.EQU pcint21 = 5
.EQU pcint20 = 4
.EQU pcint19 = 3
.EQU pcint18 = 2
.EQU pcint17 = 1
.EQU pcint16 = 0
.EQU eicra = 105
.EQU isc11 = 3
.EQU isc10 = 2
.EQU isc01 = 1
.EQU isc00 = 0
.EQU eimsk = 61
.EQU int0 = 0
.EQU int1 = 1
.EQU eifr = 60
.EQU intf0 = 0
.EQU intf1 = 1
.EQU eearh = 66
.EQU eearl = 65
.EQU eedr = 64
.EQU eecr = 63
.EQU eepm1 = 5
.EQU eepm0 = 4
.EQU eerie = 3
.EQU eempe = 2
.EQU eemwe = 2
.EQU eepe = 1
.EQU eewe = 1
.EQU eere = 0
.EQU admux = 124
.EQU refs1 = 7
.EQU refs0 = 6
.EQU adlar = 5
.EQU mux3 = 3
.EQU mux2 = 2
.EQU mux1 = 1
.EQU mux0 = 0
.EQU adcsra = 122
.EQU aden = 7
.EQU adsc = 6
.EQU adate = 5
.EQU adif = 4
.EQU adie = 3
.EQU adps2 = 2
.EQU adps1 = 1
.EQU adps0 = 0
.EQU adcsrb = 123
.EQU acme = 6
.EQU adts2 = 2
.EQU adts1 = 1
.EQU adts0 = 0
.EQU adcl = 120
.EQU adch = 121
.EQU adc0 = 0
.EQU adc1 = 1
.EQU adc2 = 2
.EQU adc3 = 3
.EQU adc4 = 4
.EQU adc5 = 5
.EQU adc6 = 6
.EQU adc7 = 7
.EQU adct = 8
.EQU spcr = 76
.EQU spie = 7
.EQU spe = 6
.EQU dord = 5
.EQU mstr = 4
.EQU cpol = 3
.EQU cpha = 2
.EQU spr1 = 1
.EQU spr0 = 0
.EQU spsr = 77
.EQU spif = 7
.EQU wcol = 6
.EQU spi2x = 0
.EQU spdr = 78
.EQU spmcsr = 87
.EQU spmcr = 87
.EQU spmie = 7
.EQU rwwsb = 6
.EQU sigrd = 5
.EQU rwwsre = 4
.EQU blbset = 3
.EQU pgwrt = 2
.EQU pgers = 1
.EQU spmen = 0
.EQU wdtcr = 96
.EQU wdif = 7
.EQU wdie = 6
.EQU wdp3 = 5
.EQU wdce = 4
.EQU wde = 3
.EQU wdp2 = 2
.EQU wdp1 = 1
.EQU wdp0 = 0
.EQU adc_vref_aref = 0
.EQU adc_vref_avcc = 64
.EQU adc_vref_1_1_cap = 192
.EQU adc_presc_x1 = 0
.EQU adc_presc_x2 = 1
.EQU adc_presc_x4 = 2
.EQU adc_presc_x8 = 3
.EQU adc_presc_x16 = 4
.EQU adc_presc_x32 = 5
.EQU adc_presc_x64 = 6
.EQU adc_presc_x128 = 7
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/devices/common.def
.IFNDEF os_feature_ir_table # false
.ENDIF
.IFNDEF os_feature_logging # false
.ENDIF
.IFNDEF os_feature_welcome # true
.EQU os_feature_welcome = 1
.ENDIF
.IFNDEF os_feature_init_diagnostic # true
.EQU os_feature_init_diagnostic = 1
.ENDIF
.IFNDEF os_feature_timer1 # false
.ENDIF
.IFNDEF os_feature_timer2 # false
.ENDIF
.IFNDEF core_freq # false
.ENDIF
.EQU _os_timer_freq = 50
.EQU pinx = 0
.EQU ddrx = 1
.EQU portx = 2
.SET jmp_support = 0
.EQU pa0 = 0
.EQU pa1 = 1
.EQU pa2 = 2
.EQU pa3 = 3
.EQU pa4 = 4
.EQU pa5 = 5
.EQU pa6 = 6
.EQU pa7 = 7
.EQU pb0 = 16
.EQU pb1 = 17
.EQU pb2 = 18
.EQU pb3 = 19
.EQU pb4 = 20
.EQU pb5 = 21
.EQU pb6 = 22
.EQU pb7 = 23
.EQU pc0 = 32
.EQU pc1 = 33
.EQU pc2 = 34
.EQU pc3 = 35
.EQU pc4 = 36
.EQU pc5 = 37
.EQU pc6 = 38
.EQU pc7 = 39
.EQU pd0 = 48
.EQU pd1 = 49
.EQU pd2 = 50
.EQU pd3 = 51
.EQU pd4 = 52
.EQU pd5 = 53
.EQU pd6 = 54
.EQU pd7 = 55
.EQU pe0 = 64
.EQU pe1 = 65
.EQU pe2 = 66
.EQU pe3 = 67
.EQU pe4 = 68
.EQU pe5 = 69
.EQU pe6 = 70
.EQU pe7 = 71
.EQU pf0 = 80
.EQU pf1 = 81
.EQU pf2 = 82
.EQU pf3 = 83
.EQU pf4 = 84
.EQU pf5 = 85
.EQU pf6 = 86
.EQU pf7 = 87
.EQU pg0 = 96
.EQU pg1 = 97
.EQU pg2 = 98
.EQU pg3 = 99
.EQU pg4 = 100
.EQU pg5 = 101
.EQU pg6 = 102
.EQU pg7 = 103
.EQU isc_low_level = 0
.EQU isc_any_change = 1
.EQU isc_falling_edge = 2
.EQU isc_rising_edge = 3
.SET int0_port = 255
.SET int1_port = 255
.SET int2_port = 255
.SET int3_port = 255
.SET int4_port = 255
.SET int5_port = 255
.SET int6_port = 255
.SET int7_port = 255
.DEF _core_reg_l = r9
.DEF _core_reg_h = r10
.DEF c0x00 = r11
.DEF c0x01 = r12
.DEF c0xff = r13
.DEF id_l = r14
.DEF id_h = r15
.DEF accum_l = r16
.DEF accum_h = r17
.DEF accum_el = r18
.DEF accum_eh = r19
.DEF flags = r20
.DEF loop_cntr = r21
.DEF temp_l = r22
.DEF temp_h = r23
.DEF temp_el = r24
.DEF temp_eh = r25
.MACRO push_x
.ENDMACRO
.MACRO pop_x
.ENDMACRO
.MACRO push_y
.ENDMACRO
.MACRO pop_y
.ENDMACRO
.MACRO push_z
.ENDMACRO
.MACRO pop_z
.ENDMACRO
.MACRO ldi_x
.ENDMACRO
.MACRO ldi_y
.ENDMACRO
.MACRO ldi_z
.ENDMACRO
.MACRO ldi_t16
.ENDMACRO
.MACRO ldi_t32
.ENDMACRO
.MACRO push_t16
.ENDMACRO
.MACRO pop_t16
.ENDMACRO
.MACRO push_t32
.ENDMACRO
.MACRO pop_t32
.ENDMACRO
.MACRO ldi_a16
.ENDMACRO
.MACRO ldi_a32
.ENDMACRO
.MACRO push_a16
.ENDMACRO
.MACRO pop_a16
.ENDMACRO
.MACRO push_a32
.ENDMACRO
.MACRO pop_a32
.ENDMACRO
.SET _mcall_size = 2
.EQU os_ir_qnt = 26
.EQU os_pcint_ports_qnt = 3
.EQU os_ram_border_size = 32
.SET os_stack_size = 96
.SET os_io_buffer_size = 128
.EQU sda = 36
.EQU scl = 37
.EQU rxd = 48
.EQU txd = 49
.EQU rxd0 = 48
.EQU txd0 = 49
.EQU sck = 21
.EQU miso = 20
.EQU mosi = 19
.EQU ss = 18
.EQU oc2a = 19
.SET int0_port = 50
.SET int1_port = 51
.EQU c5_ir_int0 = 1
.EQU c5_ir_int1 = 2
.EQU c5_ir_pcint0 = 3
.EQU c5_ir_pcint1 = 4
.EQU c5_ir_pcint2 = 5
.EQU c5_ir_wdt = 6
.EQU c5_ir_timer2_compa = 7
.EQU c5_ir_timer2_compb = 8
.EQU c5_ir_timer2_ovf = 9
.EQU c5_ir_timer1_capt = 10
.EQU c5_ir_timer1_compa = 11
.EQU c5_ir_timer1_compb = 12
.EQU c5_ir_timer1_ovf = 13
.EQU c5_ir_reserved_core_timer1 = 14
.EQU c5_ir_reserved_core_timer2 = 15
.EQU c5_ir_timer0_ovf = 16
.EQU c5_ir_spi = 17
.EQU c5_ir_uart_rx = 18
.EQU c5_ir_uart_udre = 19
.EQU c5_ir_uart_tx = 20
.EQU c5_ir_adc = 21
.EQU c5_ir_ee_ready = 22
.EQU c5_ir_analog_comp = 23
.EQU c5_ir_twi = 24
.EQU c5_ir_spm_ready = 25
.EQU porta = 255
.EQU ddra = 255
.EQU pina = 255
.EQU portb = 5
.EQU ddrb = 4
.EQU pinb = 3
.EQU portc = 8
.EQU ddrc = 7
.EQU pinc = 6
.EQU portd = 11
.EQU ddrd = 10
.EQU pind = 9
.EQU porte = 255
.EQU ddre = 255
.EQU pine = 255
.EQU portf = 255
.EQU ddrf = 255
.EQU pinf = 255
.EQU portg = 255
.EQU ddrg = 255
.EQU ping = 255
.ORG 0
0x0000 jmp _os_init
.IF  # true
0x0002 call _os_ir_handler
0x0004 call _os_ir_handler
0x0006 call _os_ir_handler
0x0008 call _os_ir_handler
0x000A call _os_ir_handler
0x000C call _os_ir_handler
0x000E call _os_ir_handler
0x0010 call _os_ir_handler
0x0012 call _os_ir_handler
0x0014 call _os_ir_handler
0x0016 call _os_ir_handler
0x0018 call _os_ir_handler
0x001A call _os_ir_handler
.IF  # true
0x001C jmp _os_timer1_handler
.ELSE
.ENDIF
.IF  # true
0x001E jmp _os_timer2_handler
.ELSE
.ENDIF
0x0020 call _os_ir_handler
0x0022 call _os_ir_handler
0x0024 call _os_ir_handler
0x0026 call _os_ir_handler
0x0028 call _os_ir_handler
0x002A call _os_ir_handler
0x002C call _os_ir_handler
0x002E call _os_ir_handler
0x0030 call _os_ir_handler
0x0032 call _os_ir_handler
.ENDIF
ports_table: 0x0034
.DB 0x00232629 # #&)
pcint_table: 0x0036
.DB 0x006B6C6D # klm
int_table: 0x0038
.DB 0x0102 #
.MACRO mcall
.ENDMACRO
.MACRO mjmp
.ENDMACRO
.MACRO _os_power_on
.ENDMACRO
.MACRO _os_power_off
.ENDMACRO
.MACRO _os_timers_restart
.ENDMACRO
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/core/core.asm
.IFNDEF _os_init # true
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/mem/ram_fill.asm
.IFNDEF ram_fill_nr # true
ram_fill_nr: 0x0039
_ram_fill_nr__loop: 0x0039
0x0039 st r26+, accum_l
0x003A sbiw yl, 1
0x003B brne _ram_fill_nr__loop
0x003C ret
.ENDIF
.IF  # true
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/stdio/out_init.asm
.IFNDEF os_out_init # true
os_out_init: 0x003D
# MACRO IMPL push_z BEGIN []
0x003D push zl
0x003E push zh
# MACRO IMPL push_z END
0x003F push temp_l
# MACRO IMPL ldi_z BEGIN [104+logging_port>>4]
0x0040 ldi zl, 104+logging_port>>4&255
0x0041 ldi zh, 104+logging_port>>4>>8&255
# MACRO IMPL ldi_z END
0x0042 lpm zl, r30
0x0043 adiw zl, 2
0x0044 clr zh
0x0045 ld temp_l, r30
0x0046 ori temp_l, 1<<logging_port&15
0x0047 st r30, temp_l
# MACRO IMPL ldi_z BEGIN [104+logging_port>>4]
0x0048 ldi zl, 104+logging_port>>4&255
0x0049 ldi zh, 104+logging_port>>4>>8&255
# MACRO IMPL ldi_z END
0x004A lpm zl, r30
0x004B adiw zl, 1
0x004C clr zh
0x004D ld temp_l, r30
0x004E ori temp_l, 1<<logging_port&15
0x004F st r30, temp_l
0x0050 pop temp_l
# MACRO IMPL pop_z BEGIN []
0x0051 pop zh
0x0052 pop zl
# MACRO IMPL pop_z END
0x0053 ret
.ENDIF
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/stdio/out_cstr.asm
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/stdio/out_char.asm
.IFNDEF os_out_char # true
os_out_char: 0x0054
# MACRO IMPL push_z BEGIN []
0x0054 push zl
0x0055 push zh
# MACRO IMPL push_z END
0x0056 push accum_l
0x0057 push loop_cntr
0x0058 push temp_l
0x0059 push flags
# MACRO IMPL ldi_z BEGIN [104+logging_port>>4]
0x005A ldi zl, 104+logging_port>>4&255
0x005B ldi zh, 104+logging_port>>4>>8&255
# MACRO IMPL ldi_z END
0x005C lpm zl, r30
0x005D adiw zl, 2
0x005E clr zh
0x005F ld temp_l, r30
0x0060 ori temp_l, 1<<logging_port&15
0x0061 st r30, temp_l
0x0062 ldi temp_l, 20
0x0063 dec temp_l
0x0064 brne 99
0x0065 lds flags, sreg
0x0067 cli
0x0068 ld temp_l, r30
0x0069 andi temp_l, 1<<logging_port&15BIT_NOT&255
0x006A st r30, temp_l
0x006B ldi temp_l, 20
0x006C dec temp_l
0x006D brne 108
0x006E ldi loop_cntr, 8
_os_out_char__loop: 0x006F
0x006F ld temp_l, r30
0x0070 sbrc accum_l, 0
0x0071 ori temp_l, 1<<logging_port&15
0x0072 sbrs accum_l, 0
0x0073 andi temp_l, 1<<logging_port&15BIT_NOT&255
0x0074 lsr accum_l
0x0075 st r30, temp_l
0x0076 nop
0x0077 ldi temp_l, 19
0x0078 dec temp_l
0x0079 brne 120
0x007A dec loop_cntr
0x007B brne _os_out_char__loop
0x007C ld temp_l, r30
0x007D ori temp_l, 1<<logging_port&15
0x007E st r30, temp_l
0x007F sts sreg, flags
0x0081 pop flags
0x0082 pop temp_l
0x0083 pop loop_cntr
0x0084 pop accum_l
# MACRO IMPL pop_z BEGIN []
0x0085 pop zh
0x0086 pop zl
# MACRO IMPL pop_z END
0x0087 ret
.ENDIF
.IFNDEF os_out_cstr # true
os_out_cstr: 0x0088
0x0088 push temp_l
# MACRO IMPL push_z BEGIN []
0x0089 push zl
0x008A push zh
# MACRO IMPL push_z END
_os_out_cstr__loop: 0x008B
0x008B lpm temp_l, r30+
0x008C cpi temp_l, 0
0x008D breq _os_out_cstr__end
# MACRO IMPL mcall BEGIN [os_out_char]
0x008E call os_out_char
# MACRO IMPL mcall END
0x0090 rjmp _os_out_cstr__loop
_os_out_cstr__end: 0x0091
# MACRO IMPL pop_z BEGIN []
0x0091 pop zh
0x0092 pop zl
# MACRO IMPL pop_z END
0x0093 pop temp_l
0x0094 ret
.ENDIF
.ENDIF
.EQU _os_timer_tick_period = 20
.IF  # true
.IF  # true
.MESSAGE ######## LOGGING ENABLED
.MESSAGE ######## IO BAUDRATE:115200
cstr_osname: 0x0095
.DB 0x766D353237372E6176722076302E3100 #vm5277.avr v0.1 
cstr_osmsg1: 0x009D
.DB 0x0D0A506F77657265642062792000 #\r\nPowered by  
.ENDIF
.IF  # true
cstr_osmsg2: 0x00A4
.DB 0x205B0000 # [  
cstr_mcusr_no: 0x00A6
.DB 0x4E4F2000 #NO  
cstr_mcusr_wd: 0x00A8
.DB 0x57442000 #WD  
cstr_mcusr_bo: 0x00AA
.DB 0x424F2000 #BO  
cstr_mcusr_ex: 0x00AC
.DB 0x45582000 #EX  
cstr_mcusr_po: 0x00AE
.DB 0x504F2000 #PO  
cstr_mcusr_reset: 0x00B0
.DB 0x72657365745D0D0A0000 #reset]\r\n  
.ENDIF
.ENDIF
.SET _os_roto = 256
.IF  # true
.EQU _os_uptime = 256
.EQU _os_timer1_cntr = 261
.EQU _os_timer_tick_threshold = 263
.SET _os_roto = 264
.ENDIF
.IF  # true
.EQU _os_ir_vectors_table = 264
.SET _os_roto = 78
.ENDIF
_os_init: 0x00B5
0x00B5 cli
.IFDEF sph # true
0x00B6 ldi temp_l, 8
0x00B7 sts sph, temp_l
.ENDIF
0x00B9 ldi temp_l, 255
0x00BA sts spl, temp_l
0x00BC eor c0x00, c0x00
0x00BD ldi temp_l, 255
0x00BE mov c0xff, temp_l
0x00BF lds temp_h, mcusr
0x00C1 wdr
0x00C2 lds temp_l, mcusr
0x00C4 andi temp_l, 247
0x00C5 sts mcusr, temp_l
0x00C7 lds temp_l, wdtcr
0x00C9 ori temp_l, 24
0x00CA sts wdtcr, temp_l
0x00CC ldi temp_l, 0
0x00CD sts wdtcr, temp_l
.IF  # true
# MACRO IMPL mcall BEGIN [os_out_init]
0x00CF call os_out_init
# MACRO IMPL mcall END
.IF  # true
# MACRO IMPL ldi_z BEGIN [cstr_osmsg1]
0x00D1 ldi zl, 157
0x00D2 ldi zh, 0
# MACRO IMPL ldi_z END
# MACRO IMPL mcall BEGIN [os_out_cstr]
0x00D3 call os_out_cstr
# MACRO IMPL mcall END
# MACRO IMPL ldi_z BEGIN [cstr_osname]
0x00D5 ldi zl, 149
0x00D6 ldi zh, 0
# MACRO IMPL ldi_z END
# MACRO IMPL mcall BEGIN [os_out_cstr]
0x00D7 call os_out_cstr
# MACRO IMPL mcall END
.ENDIF
.IF  # true
# MACRO IMPL ldi_z BEGIN [cstr_osmsg2]
0x00D9 ldi zl, 164
0x00DA ldi zh, 0
# MACRO IMPL ldi_z END
# MACRO IMPL mcall BEGIN [os_out_cstr]
0x00DB call os_out_cstr
# MACRO IMPL mcall END
0x00DD sbrs flags, wdrf
0x00DE rjmp 227
# MACRO IMPL ldi_z BEGIN [cstr_mcusr_wd]
0x00DF ldi zl, 168
0x00E0 ldi zh, 0
# MACRO IMPL ldi_z END
# MACRO IMPL mcall BEGIN [os_out_cstr]
0x00E1 call os_out_cstr
# MACRO IMPL mcall END
0x00E3 sbrs flags, borf
0x00E4 rjmp 233
# MACRO IMPL ldi_z BEGIN [cstr_mcusr_bo]
0x00E5 ldi zl, 170
0x00E6 ldi zh, 0
# MACRO IMPL ldi_z END
# MACRO IMPL mcall BEGIN [os_out_cstr]
0x00E7 call os_out_cstr
# MACRO IMPL mcall END
0x00E9 sbrs flags, extrf
0x00EA rjmp 239
# MACRO IMPL ldi_z BEGIN [cstr_mcusr_ex]
0x00EB ldi zl, 172
0x00EC ldi zh, 0
# MACRO IMPL ldi_z END
# MACRO IMPL mcall BEGIN [os_out_cstr]
0x00ED call os_out_cstr
# MACRO IMPL mcall END
0x00EF sbrs flags, porf
0x00F0 rjmp 245
# MACRO IMPL ldi_z BEGIN [cstr_mcusr_po]
0x00F1 ldi zl, 174
0x00F2 ldi zh, 0
# MACRO IMPL ldi_z END
# MACRO IMPL mcall BEGIN [os_out_cstr]
0x00F3 call os_out_cstr
# MACRO IMPL mcall END
0x00F5 mov temp_l, flags
0x00F6 andi temp_l, 15
0x00F7 brne 252
# MACRO IMPL ldi_z BEGIN [cstr_mcusr_no]
0x00F8 ldi zl, 166
0x00F9 ldi zh, 0
# MACRO IMPL ldi_z END
# MACRO IMPL mcall BEGIN [os_out_cstr]
0x00FA call os_out_cstr
# MACRO IMPL mcall END
# MACRO IMPL ldi_z BEGIN [cstr_mcusr_reset]
0x00FC ldi zl, 176
0x00FD ldi zh, 0
# MACRO IMPL ldi_z END
# MACRO IMPL mcall BEGIN [os_out_cstr]
0x00FE call os_out_cstr
# MACRO IMPL mcall END
.ENDIF
.ENDIF
0x0100 sts mcusr, c0x00
.IF  # true
0x0102 ldi accum_l, 82
# MACRO IMPL ldi_x BEGIN [sram_start]
0x0103 ldi xl, 0
0x0104 ldi xh, 1
# MACRO IMPL ldi_x END
# MACRO IMPL ldi_y BEGIN [2033]
0x0105 ldi yl, 241
0x0106 ldi yh, 7
# MACRO IMPL ldi_y END
# MACRO IMPL mcall BEGIN [ram_fill_nr]
0x0107 call ram_fill_nr
# MACRO IMPL mcall END
.ENDIF
.IF  # true
0x0109 ldi accum_l, 0
# MACRO IMPL ldi_x BEGIN [_os_uptime]
0x010A ldi xl, 0
0x010B ldi xh, 1
# MACRO IMPL ldi_x END
# MACRO IMPL ldi_y BEGIN [5]
0x010C ldi yl, 5
0x010D ldi yh, 0
# MACRO IMPL ldi_y END
# MACRO IMPL mcall BEGIN [ram_fill_nr]
0x010E call ram_fill_nr
# MACRO IMPL mcall END
.ENDIF
os_softreset: 0x0110
.IF  # true
0x0110 ldi accum_l, 255
# MACRO IMPL ldi_x BEGIN [_os_ir_vectors_table]
0x0111 ldi xl, 8
0x0112 ldi xh, 1
# MACRO IMPL ldi_x END
# MACRO IMPL ldi_y BEGIN [78]
0x0113 ldi yl, 78
0x0114 ldi yh, 0
# MACRO IMPL ldi_y END
# MACRO IMPL mcall BEGIN [ram_fill_nr]
0x0115 call ram_fill_nr
# MACRO IMPL mcall END
.ENDIF
.IF  # true
0x0117 sts 261, c0x00
0x0119 sts 262, c0x00
0x011B ldi temp_l, _os_timer_tick_period
0x011C sts _os_timer_tick_threshold, temp_l
# MACRO IMPL _os_timers_restart BEGIN []
# MACRO IMPL _os_power_on BEGIN [prtim0]
0x011E push temp_l
0x011F lds temp_l, prr
0x0121 andi temp_l, 223
0x0122 sts prr, temp_l
0x0124 pop temp_l
# MACRO IMPL _os_power_on END
0x0125 push temp_l
0x0126 ldi temp_l, 0
0x0127 sts tccr0a, temp_l
0x0129 ldi temp_l, 2
0x012A sts tccr0b, temp_l
0x012C sts tcnt0, c0x00
0x012E ldi temp_l, 49
0x012F sts ocr0a, temp_l
0x0131 ldi temp_l, 2
0x0132 sts tifr0, temp_l
0x0134 ldi temp_l, 2
0x0135 sts timsk0, temp_l
0x0137 pop temp_l
# MACRO IMPL _os_timers_restart END
.ENDIF
0x0138 sei
0x0139 jmp main
_os_ir_handler: 0x013B
0x013B reti
.IF  # true
_os_timer1_handler: 0x013C
# MACRO IMPL push_t32 BEGIN []
0x013C push temp_l
0x013D push temp_h
0x013E push temp_el
0x013F push temp_eh
# MACRO IMPL push_t32 END
# MACRO IMPL push_z BEGIN []
0x0140 push zl
0x0141 push zh
# MACRO IMPL push_z END
0x0142 lds temp_el, 261
0x0144 lds temp_eh, 262
0x0146 adiw temp_el, 1
0x0147 sts 261, temp_el
0x0149 sts 262, temp_eh
0x014B lds temp_l, _os_timer_tick_threshold
0x014D cp temp_l, temp_el
0x014E brne _os_timer1_handler__end
0x014F subi temp_l, 236
0x0150 sts _os_timer_tick_threshold, temp_l
# MACRO IMPL ldi_z BEGIN [_os_uptime]
0x0152 ldi zl, 0
0x0153 ldi zh, 1
# MACRO IMPL ldi_z END
0x0154 ld temp_l, r30
0x0155 add temp_l, c0x01
0x0156 st r30+, temp_l
0x0157 ld temp_l, r30
0x0158 adc temp_l, c0x00
0x0159 st r30+, temp_l
0x015A ld temp_l, r30
0x015B adc temp_l, c0x00
0x015C st r30+, temp_l
0x015D ld temp_l, r30
0x015E adc temp_l, c0x00
0x015F st r30+, temp_l
0x0160 ld temp_l, r30
0x0161 adc temp_l, c0x00
0x0162 st r30, temp_l
_os_timer1_handler__end: 0x0163
# MACRO IMPL pop_z BEGIN []
0x0163 pop zh
0x0164 pop zl
# MACRO IMPL pop_z END
# MACRO IMPL pop_t32 BEGIN []
0x0165 pop temp_eh
0x0166 pop temp_el
0x0167 pop temp_l
0x0168 pop temp_h
# MACRO IMPL pop_t32 END
0x0169 reti
.ENDIF
.IF  # true
_os_timer2_handler: 0x016A
0x016A reti
.ENDIF
.ENDIF
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/io/port_mode_out.asm
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/io/_port_offset.asm
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/conv/_bit_to_mask_table.asm
.IFNDEF _bit_to_mask_table # true
_bit_to_mask_table: 0x016B
.DB 0x0102040810204080 # @ï¿½
.ENDIF
.IFNDEF _port_offset # true
_port_offset: 0x016F
0x016F push temp_l
0x0170 mov temp_l, accum_l
0x0171 andi accum_l, 15
# MACRO IMPL ldi_z BEGIN [726]
0x0172 ldi zl, 214
0x0173 ldi zh, 2
# MACRO IMPL ldi_z END
0x0174 add zl, accum_l
0x0175 adc zh, c0x00
0x0176 lpm accum_l, r30
0x0177 swap temp_l
0x0178 andi temp_l, 15
# MACRO IMPL ldi_z BEGIN [104]
0x0179 ldi zl, 104
0x017A ldi zh, 0
# MACRO IMPL ldi_z END
0x017B add zl, temp_l
0x017C adc zh, c0x00
0x017D lpm zl, r30
0x017E ldi zh, 0
0x017F pop temp_l
0x0180 ret
.ENDIF
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/io/reg_bit_hi.asm
.IFNDEF reg_bit_hi # true
reg_bit_hi: 0x0181
# MACRO IMPL push_t16 BEGIN []
0x0181 push temp_l
0x0182 push temp_h
# MACRO IMPL push_t16 END
0x0183 lds temp_h, sreg
0x0185 cli
0x0186 ld temp_l, r30
0x0187 or temp_l, accum_l
0x0188 st r30, temp_l
0x0189 sts sreg, temp_h
# MACRO IMPL pop_t16 BEGIN []
0x018B pop temp_h
0x018C pop temp_l
# MACRO IMPL pop_t16 END
0x018D ret
.ENDIF
.IFNDEF port_mode_out # true
port_mode_out: 0x018E
0x018E cpi accum_l, 255
0x018F brne 401
0x0190 ret
# MACRO IMPL push_z BEGIN []
0x0191 push zl
0x0192 push zh
# MACRO IMPL push_z END
0x0193 push accum_l
# MACRO IMPL mcall BEGIN [_port_offset]
0x0194 call _port_offset
# MACRO IMPL mcall END
0x0196 adiw zl, 1
# MACRO IMPL mcall BEGIN [reg_bit_hi]
0x0197 call reg_bit_hi
# MACRO IMPL mcall END
0x0199 pop accum_l
# MACRO IMPL pop_z BEGIN []
0x019A pop zh
0x019B pop zl
# MACRO IMPL pop_z END
0x019C ret
.ENDIF
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/io/port_set_hi.asm
.IFNDEF port_set_hi # true
port_set_hi: 0x019D
0x019D cpi accum_l, 255
0x019E brne 416
0x019F ret
# MACRO IMPL push_z BEGIN []
0x01A0 push zl
0x01A1 push zh
# MACRO IMPL push_z END
0x01A2 push accum_l
# MACRO IMPL mcall BEGIN [_port_offset]
0x01A3 call _port_offset
# MACRO IMPL mcall END
0x01A5 adiw zl, 2
# MACRO IMPL mcall BEGIN [reg_bit_hi]
0x01A6 call reg_bit_hi
# MACRO IMPL mcall END
0x01A8 pop accum_l
# MACRO IMPL pop_z BEGIN []
0x01A9 pop zh
0x01AA pop zl
# MACRO IMPL pop_z END
0x01AB ret
.ENDIF
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/io/port_set_lo.asm
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/io/reg_bit_lo.asm
.IFNDEF reg_bit_lo # true
reg_bit_lo: 0x01AC
# MACRO IMPL push_t16 BEGIN []
0x01AC push temp_l
0x01AD push temp_h
# MACRO IMPL push_t16 END
0x01AE push accum_l
0x01AF com accum_l
0x01B0 lds temp_h, sreg
0x01B2 cli
0x01B3 ld temp_l, r30
0x01B4 and temp_l, accum_l
0x01B5 st r30, temp_l
0x01B6 sts sreg, temp_h
0x01B8 pop accum_l
# MACRO IMPL pop_t16 BEGIN []
0x01B9 pop temp_h
0x01BA pop temp_l
# MACRO IMPL pop_t16 END
0x01BB ret
.ENDIF
.IFNDEF port_set_lo # true
port_set_lo: 0x01BC
0x01BC cpi accum_l, 255
0x01BD brne 447
0x01BE ret
# MACRO IMPL push_z BEGIN []
0x01BF push zl
0x01C0 push zh
# MACRO IMPL push_z END
0x01C1 push accum_l
# MACRO IMPL mcall BEGIN [_port_offset]
0x01C2 call _port_offset
# MACRO IMPL mcall END
0x01C4 adiw zl, 2
# MACRO IMPL mcall BEGIN [reg_bit_lo]
0x01C5 call reg_bit_lo
# MACRO IMPL mcall END
0x01C7 pop accum_l
# MACRO IMPL pop_z BEGIN []
0x01C8 pop zh
0x01C9 pop zl
# MACRO IMPL pop_z END
0x01CA ret
.ENDIF
.INCLUDE /home/kostas/repos/w5277c/vm5277_local/rtos/avr/core/wait_ms.asm
.IFNDEF wait_ms # true
wait_ms: 0x01CB
0x01CB push accum_h
0x01CC push accum_l
# MACRO IMPL push_t16 BEGIN []
0x01CD push temp_l
0x01CE push temp_h
# MACRO IMPL push_t16 END
0x01CF lds temp_h, 261
_wait_ms__loop: 0x01D1
0x01D1 lds temp_l, 261
0x01D3 cp temp_h, temp_l
0x01D4 breq _wait_ms__loop
0x01D5 lds temp_l, 261
0x01D7 sub accum_l, temp_l
0x01D8 sbc accum_h, c0x00
0x01D9 brcc _wait_ms__loop
# MACRO IMPL pop_t16 BEGIN []
0x01DA pop temp_h
0x01DB pop temp_l
# MACRO IMPL pop_t16 END
0x01DC pop accum_l
0x01DD pop accum_h
0x01DE ret
.ENDIF
.EQU logging_port = 21
.EQU led_port = 16
main: 0x01DF
0x01DF ldi accum_l, led_port
0x01E0 call port_mode_out
loop: 0x01E2
0x01E2 ldi accum_l, led_port
0x01E3 call port_set_lo
0x01E5 ldi accum_h, 0
0x01E6 ldi accum_l, 100
0x01E7 call wait_ms
0x01E9 ldi accum_l, led_port
0x01EA call port_set_hi
0x01EC ldi accum_h, 0
0x01ED ldi accum_l, 100
0x01EE call wait_ms
0x01F0 rjmp loop
