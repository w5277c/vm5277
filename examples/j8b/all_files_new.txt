/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
    public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		short s1 = 0x0000;
		s1++;
		short s2 = 0x000f;
		s2++;
		short s3 = 0x00ff;
		s3++;
		short s4 = 0x0fff;
		s4++;
		// Инкремент необходим в качестве reassigned, иначе свернется в константу
		System.out((s1+s2) + (s3+s4));
    }
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

class Main {
    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);

/*		byte[] arr = new byte[4];
		arr[1] = 8;
		System.out(arr[1]);
*/
		int[] bArray1 = new int[2];
		int[] bArray2 = new int[4];
		System.out(bArray1[(short)bArray2[3]]);

		bArray1[0]=bArray2[1];
		System.out(' ');
		if(bArray1[1]>2) {
			System.out('!');
		}

		byte bt;
		bt=3;

		bool bl = bArray1[0]>bt && bt==2; //Нет загрузки значения из X в аккумулятор
		System.out(bl);
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

class Main {
    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);

		byte[][] b1 = new byte[4][5];
		System.out(b1.length);
		byte[] b2 = b1[3];
		System.out(b2[1]);
		System.out(b2[2]);

		byte b;

		byte[] arr = new byte[10];

		short s = arr.length;
		System.out(s);

		byte[][] matrix = new byte[3][3];
		matrix[0][1] = matrix[1][0];


		b = arr[0] + arr[1];

		System.out(method1(arr));

		System.out(method2(2)[1]);

		arr[method3()] = 0;
		b = arr[method3()];

		arr[0]++;
		--arr[0];

		arr[arr[arr[0]]] = arr[method1(arr)] + method2(5)[0];
	}

	public static byte method1(byte[] barr) {
		return barr[1];
	}

	public static byte[] method2(byte b) {
		return new byte[b];
	}

	public static byte method3() {
		return 3;
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

class Main {
    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);

		byte b1 = 254;
		b1++;
		fixed[][] arr = new fixed[][]{{0.5,-1},{-2*2,(fixed)b1},{-4,100.99}};
//TODO не сохранять в стек Z при вызове функци типа os_rom_read16_nr, os_dram_alloc и прочие, если не обращаемся в этом методе к свойствам класса и к this
		System.out(arr[0][0]);

		byte size=8;
		short[] arr2 = new short[size];
		arr2[1] = 3;

		short s=0x0101;
		s++;
		if(s<arr2[3]) {
			System.out(arr2[3]);
		}

		arr[0][0] = (fixed)arr2[1];
		arr = null;
		arr2 = null;
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

class Main {

	public static bool test(bool _b1, bool _b2) {
		return _b1 && _b2;
	}

    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);

		bool b10 = false;
		b10 = !b10;
		bool b1 = false;
		b1 = !b1;
		bool b2 = true;
		b2 = !b2;
// Инверсия необходима в качестве reassigned, иначе свернется в константы

		System.out(true);
		System.out(false);
		System.out(!true);
		System.out(!false);
		System.out(b1);
		System.out(b2);
		System.out(!b1);
		System.out(!b2);

		bool b3 = !b1;
		System.out(b3);

		if(b1==b2) {
			System.out('0'); //48
		}

		if(b1) {
			System.out('1'); //49
		}
		if(b2) {
			System.out('2'); //50
		}
		if(!b2) {
			System.out('3'); //51
		}


		if(b1 || b2) {
			System.out('4'); //52
		}
		if(b1 && b2) {
			System.out('5'); //53
		}

		System.out(test(b1, b2));

		bool b4 = b1 || b2 || b10;
		System.out(b4);
		bool b5 = b1 && b2;
		System.out(b5);
		bool b6 = !b1;
		System.out(b6);
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
    public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);

		int i = 0x04030201;
		System.outCStr("orig num:");
		System.out(i);
		System.outChar('\n');

		i = (int)(short)(int)(short)i;
		System.outCStr("short:");
		System.out(i);
		System.outChar('\n');

		System.outCStr("byte:");
		System.out((byte)i);
		System.outChar('\n');
    }
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
    public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		byte i1 = 0x01;
		byte i2 = 0x02;
		byte sum = i1 + i2;
		System.out(i1);
		System.out(i2);
		System.out(sum);

		final cstr text="Hello world!";
		System.outCStr(text);
		final byte newLine = '\n';
		System.outChar(newLine);

		int a = 1;
		int b = 2;
		int c = (byte)(a+(short)b);

		byte num = 'A';
		num++;
		System.outChar(num);

		System.outChar('!');

		int i = (short)0x04030201;
		System.out(i);
		i++;
		System.out(i);
		System.stop();
    }
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
	public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		if(true) {
			System.outChar('A'); //65
		}

		if(false) {
			System.outChar('B'); //66
		}

		if(3==1+2) {
			System.outChar('C'); //67
		}

		if(1!=2) {
			System.outChar('D'); //68
		}
		else {
			System.outChar('E'); //69
		}

		byte s1;
		s1=0x01;
		if(s1==0x03) {
			System.outChar(' '); //32
		}

		bool b1;
		b1=false;
		if(b1) {
			System.out('2'); //50
		}
		if(!b1) {
			System.out('3'); //51
		}


		byte i=1;
		i++;
		byte j=2;
		j++;
		if(i+j<2) {
			System.outChar('F'); //70
		}
		else {
			System.outChar('G'); //71
		}
		
		System.out(i>j ? 'Y' : 'N');
		System.out(true ? 'Y' : 'N');
		System.out(false ? 'Y' : 'N');
		System.out(method(false) ? 'Y' : 'N');
		System.out(method(false) ? method(true) : method(false));
	}
	
	static bool method(bool flag) {
		return !flag;
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

class Main {

	public enum EDirection {
		LEFT,
		RIGHT,
		DOWN,
		UP;
	}

	public enum EStatus {
		OK,
		ERROR
	}

    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);

		System.out(EStatus.ERROR.index());
		System.out(EStatus.size());

		EDirection dir = EDirection.item(1);
		if(EDirection.UP==dir) {
			System.out(0x01);
		}
		else {
			System.out(0x00);
		}

		printDirection(EDirection.UP);

		EStatus st = EStatus.OK;
		System.out(st.index());

		EStatus s = EStatus.item(EStatus.ERROR.index());
		System.out(s.index());

		System.out(EStatus.item(1).index());


//Должно вызывать ошибки
/*		System.out(EStatus);
		System.out(EStatus.UP);
		System.out(EStatus.OK.length);
		System.out(EStatus.length);
		System.out(EStatus.OK.size());
		System.out(EStatus.ERROR.item(1));
		System.out(EStatus.index());
		EStatus es1 = EStatus.item(5);
		EStatus es2 = EStatus.item(-1);
		EStatus es3 = EStatus.item(0, 1);
		System.out(es1.size(1));
*/
    }

    public static void printDirection(EDirection dir) {
		System.out(dir.index());
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

// Пример различных циклов, в том числе с else условием
// Частичный анализ live ranges, будет доделан позже

class Main {
    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);

		for(byte i=0; i<10; i++) {
			if(1==i) break;
			System.out(i);
		}
		else {
			System.out('!');
		}

		for(byte i=7; 4>8; i++) {
			System.out(i);
		}
		else {
			System.out('@');
		}

		for(byte i=8; 4<8; i++) {
			System.out(i);
		}

		for(byte i=0; ; i++) {
			System.out(i);
		}

		byte i=3;
		for(; i<10; i++) {
			System.out(i);
		}
		for(i=0; i<10; i++) {
			System.out(i);
		}

		for(byte i=0; i<10;) {
			System.out(i);
		}
    }
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import rtos.Thread;
import hal.GPIO;

class Main {
    public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		byte port = GPIO.PB1;
		GPIO.modeOut(port);
		while(true) {
			Thread.waitMS(250);
			GPIO.invert(port);
		}
    }

    /* TODO ввести class:
    GPIOPin pin = new GPIOPin(GPIO.PB1);
    pin.setHi();
    pin.setLo();
    pin.invert();
    bool isHi = pin.isHi();
    bool isOutMode = pin.isOutMode();
    */
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
    public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		cstr text="Hello world!\r\nПривет!\r\n";
		System.outCStr(text);

		System.stop();
    }
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
    public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		byte num = 0x20;

		byte ch = 'A';
		System.outChar(ch);
		ch++;
		System.outChar(ch);
		ch++;
		System.outChar(ch);
		ch++;
		ch = ch + num;
		System.outChar(ch);


		System.stop();
    }
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
	public interface Number {
		byte toByte();
		short toShort();
	}

	public class Short implements Number {
		private	short	value;

		public Short(short value) {
			this.value = value;
		}

		public Number getThis() {
			return this;
		}

		public byte toByte() {return (byte)value;}
		public short toShort() {return value;}
	}

	public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		Object num = new Short(0x0102);
		if(num is Short as s) {
			System.out(s.toShort());
			System.outCStr(" is short\n");
			
			if(s.getThis() is Short as s2) {
				System.outCStr("Is short too\n");
			}
		}
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
    public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		short s1;
		s1 = 10;
		fixed f1;
		f1 = 6;
		fixed f2;
		f2 = 1.5;

/*		short s1 = 10;
		fixed f1 = 6;
		fixed f2 = 1.5;
*/		
		System.out(s1 + 2);
		System.out(s1 + 1.5);
		System.out(f1 + 1.5);
		System.out(s1 - 2);
		System.out(s1 - 1.5);
		System.out(f1 - 1.5);
		System.out(s1 * 8);
		System.out(s1 * 1.5);
		System.out(f1 * 1.5);
		System.out(s1 / 8);
		System.out(s1 / 1.5);
		System.out(f1 / 1.5);
		System.out(s1 % 2);

		System.out(f1 + f2);
		System.out(f1 - f2);
		System.out(f1 * f2);
		System.out(f1 / f2);
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
	public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);

		byte a = 1;
		byte b = 2;
		byte c = 3;
		System.out(add(a+b, add(c, 8)));
	}

	private static byte add(byte b1, byte b2) {
		return b1+b2;
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
	public interface Number {
		byte toByte();
	}

	public class Byte implements Number {
		private	byte	value;

		public Byte(byte value) {
			this.value = value;
		}

		public byte toByte() {
			return value;
		}

//		public void finalize() {
//		}
	}

    public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		Byte b1 = new Byte(0x01);
		System.out(b1.toByte());
		
		Byte b2 = new Byte(0x02);
		System.out(b2.toByte());
		b1 = null;

		Byte b3 = new Byte(0x01);
		System.out(b3.toByte());
		System.out(b3.typeId());
		System.out(b3.instanceId());
		
		Byte b4 = b1;
		if(b1==b2) {
			System.out(1);
		}
		if(b1==b4) {
			System.out(2);
		}
    }
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

class Main {
	// Демонстрация выравнивания регистров под movw оптимизацию
	// Переменные распределяются в четно-нечетные пары регистров
	// для замены парных mov на единую инструкцию movw

    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);

		bool b1 = false;
		int i1 = 0x00;
		byte t1 = 0x00;

		b1 = true;
		i1 = 0x04050607;
		t1 = 0x08;

		System.out(b1);
		System.out(i1);
		System.out(t1);
	}
}
import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

class Main {
	// Оптимизация регистров через анализ областей видимости
	// Переменные из разных блоков разделяют регистры

	public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		byte a;
		a = 100;
		{
			byte b;
			b = 10;
			byte c;
			c = 20;
			System.out(b + c + a);
		}

		{
			byte d;
			d = 30;
			byte e;
			e = 40;
			System.out(d + e);

			{
				byte f;
				f = 50;
				System.out(f);
			}
		}

		byte g;
		g = 60;
		byte h;
		h = 70;
		System.out(a + g + h);
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;
import hal.GPIO;

// Демонстрирует inline AST оптимизацию вызовов get и set методов

class Main {
	public static class Clazz {
		private byte a=0;
		public void set(byte val) {
			a = val;
		}
		public byte get() {
			return a;
		}
	}

	public static byte b=1;
	public static short s=2;
	public static void set(short val2, byte val1) {
		b = val1;
		s = val2;
	}
	public static short get() {
		return s;
	}

    public static void main() {
		System.setParam(RTOSParam.CORE_FREQ, 16);
		System.setParam(RTOSParam.STDOUT_PORT, GPIO.PB2);
		System.setParam(RTOSParam.SHOW_WELCOME, 0x01);

		set(14,15);
		System.out(get());
		
		Clazz c = new Clazz();
		c.set(16);
		System.out(c.get());
    }
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

class Main {
	public static byte b1 = 123;
	public static short s1 = 32768;
	public static int i1 = 0x01020304;
	public static byte b2 = 52;
	
    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);
		s1++;
		System.out(s1);
		Test1.Test2.test=110;
		byte ttt = Test1.Test2.test;
		System.out(ttt);
		System.out(b2);
    }

	class Test1 {
		static class Test2 {
			public static byte test	= 2;
			int g=1;

			public Test2() {
				test=5;
			}

			public int getG() {
				return g;
			}
		}
	}

}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

class Main {
    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);

		bool b1;
		b1 = false;
		bool b2;
		b2 = false;

		fixed f1;
		f1 = 0;

		short s1 = 0x0102;
		short s2 = 0x0304;

		s1++;
		s1--;
		++s1;
		--s1;

		s2 = s1++;
		s2 = s1--;
		s2 = ++s1;
		s2 = --s1;

		b2 = !b1;
		s2 = -s1;

		s1 = !b1;
		f1 = !b1;
		f1 = (fixed)-s1;
		f1 = (fixed)++s1;
		f1 = (fixed)--s1;
		f1 = (fixed)s1++;
		f1 = (fixed)s1--;

		s1=s1++;
		s1=s1--;
		s1=++s1;
		s1=--s1;

		System.out(!b1 || b2);

		System.out(s1);
		System.out(s2);
		System.out(f1);
		System.out(b2);
	}
}
/*
 * Copyright 2025 konstantin@5277.ru
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import rtos.System;
import rtos.RTOSParam;

class Main {
    public static void main() {
		System.setParam(RTOSParam.STDOUT_PORT, 0x12);

		byte i=3;
		while(i<10) {
			System.out(i);
			i++;
			if(i==5) break;
		}

		while(true) {
			System.out(i);
		}

		while(false) {
			System.out(i);
		}

		while(true) {
			int i=0x11223344;
		}
    }
}
